<!doctype html>
<html lang="en">
<head>
    <title>ΟΠΚΕΑ</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="css/style.css">

    <!--webpage icon-->
    <link rel="icon" type="image/x-icon" href="images/favicon.ico"/>

</head>
<body>
<section class="ftco-section">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 text-center mb-5">
                <h2 class="heading-section">ΟΠΚΕΑ</h2>
            </div>
        </div>
        <div class="row justify-content-center">
            <div class="col-md-12 col-lg-10">
                <div class="wrap d-md-flex">
                    <div class="img" style="background-image: url(images/login_background.jpg);">
                    </div>
                    <div class="login-wrap p-4 p-md-5">
                        <div class="d-flex">
                            <div class="w-100">
                                <h3 class="mb-4 p-3 text-center">Είσοδος Χρήστη</h3>
                            </div>
                            <!--                            <div class="w-100">-->
                            <!--                                <p class="social-media d-flex justify-content-end">-->
                            <!--                                    <a href="#"-->
                            <!--                                       class="social-icon d-flex align-items-center justify-content-center"><span-->
                            <!--                                            class="fa fa-facebook"></span></a>-->
                            <!--                                    <a href="#"-->
                            <!--                                       class="social-icon d-flex align-items-center justify-content-center"><span-->
                            <!--                                            class="fa fa-twitter"></span></a>-->
                            <!--                                </p>-->
                            <!--                            </div>-->
                        </div>
                        <form action="#" class="signin-form">
                            <div class="form-group mb-3">
                                <label class="label" for="email">email</label>
                                <input id="input_email" type="text" class="form-control" placeholder="Email"
                                       required>
                            </div>
                            <div class="form-group mb-3">
                                <label class="label" for="password">κωδικος</label>
                                <input id="input_password" type="password" class="form-control" placeholder="Κωδικός"
                                       required>
                            </div>
                            <div class="form-group mb-3" id="form_name" hidden>
                                <label class="label" for="name">Όνομα</label>
                                <input id="input_name" type="text" class="form-control" placeholder="Όνομα"
                                       required>
                            </div>
                            <div class="form-group mb-3" id="form_surname" hidden>
                                <label class="label" for="surname">Επίθετο</label>
                                <input id="input_surname" type="text" class="form-control" placeholder="Επίθετο"
                                       required>
                            </div>
                            <div class="form-group">
                                <button type="reset" class="form-control btn btn-primary rounded submit px-3"
                                        onclick="signIn()">Είσοδος
                                </button>
                            </div>
                            <div class="form-group d-md-flex">
                                <div class="w-50 text-left">
                                    <label class="checkbox-wrap checkbox-primary mb-0">Αποθήκευση κωδικού
                                        <input type="checkbox" checked>
                                        <span class="checkmark"></span>
                                    </label>
                                </div>
                                <div class="w-50 text-md-right">
                                    <a href="#">Ξέχασα τον κωδικό</a>
                                </div>
                            </div>
                        </form>
                      <!--  <p class="text-center">Δεν είστε μέλος; <a data-toggle="tab" href="#signup">Εγγραφή</a></p> -->
                        <p class="text-center" id="p_signUP">Δεν είστε μέλος; <button type="reset" class="form-control btn btn-primary rounded submit px-3"
                                                                        onclick="signUp()">Εγγραφή
                        </button></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>

    var signIN = true;

    function signIn() {
        if(signIN){
            if (!(checkField("#input_email") && checkField("#input_password"))) {

                return;
            }
            const url = "https://humanrightsapplication.herokuapp.com/signin"
            const data = new URLSearchParams();

            data.append("email", $("#input_email").val());
            data.append("password", $("#input_password").val());

            console.log(data);

            const otherParam = {
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                },
                body: data,
                method: "POST"
            }

            //window.alert(otherParam.toString());
            /*
            fetch(url, otherParam)
                .then(data => {
                    window.alert(data.json())
                })
                .then(res => {
                    window.alert(res)
                })
                .catch(error => {
                    window.alert("Error nigga: " + error.message)
                })

*/


            postData(url,otherParam)
                .then(data=> {console.log(data)})

            /*
            var response =  fetch(url,otherParam)
                .then(res =>{
                    if(res.ok){
                        var data = res.json();
                        console.log(data);
                        console.log(data["response"]);

                        return data;
                    }
                    return res.text().then(text => {throw new Error(text)})
                }).catch(error => {
                console.error(error);
            })*/

        }else{
            if (!(checkField("#input_email") && checkField("#input_password")) && checkField("#input_name") && checkField("#input_surname")) {

                return;
            }

            const url = "https://humanrightsapplication.herokuapp.com/signup"
            const data = new URLSearchParams();

            data.append("email", $("#input_email").val());
            data.append("password", $("#input_password").val());
            data.append("name",$("#input_name").val());
            data.append("surname",$("#input_surname").val());

            const otherParam = {
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                },
                body: data,
                method: "POST"
            }

            postData(url,otherParam)
            .then(data=> {console.log(data.response)});
            /*
            fetch(url,otherParam)
            .then(res =>{
                if(res.ok){
                    var data = res.json();
                    console.log("Nigga m");
                    console.log(data.response);
                }
                return res.text().then(text => {throw new Error(text)})
            }).catch(error => {
                console.error(error);
            })

            */
/*
            fetch(url, otherParam)
                .then(data => {
                    window.alert(data.json())
                })
                .then(res => {
                    window.alert(res)
                })
                .catch(error => {
                    window.alert("Error nigga: " + error.message)
                })
                */

        }

       // window.location.href = "./main.html"
    }

    function signUp(){
       // window.alert("Sign up");

        var formName = document.getElementById("form_name");
        var formSurname = document.getElementById("form_surname");

        var pSignUP = document.getElementById("p_signUP");

        formName.hidden = false;
        formSurname.hidden = false;
        pSignUP.hidden = true;

        signIN = false;
    }

  async  function postData(url, params){
        const response = await  fetch(url,params)
         return response.json();
    }


    function checkField(fld) {
        var isRequired = $(fld).prop('required');
        var isValid = $(fld).prop("validity").valid;
        var isEmpty = $(fld).val() == "";
        $(fld).removeClass("is-valid").removeClass("is-invalid");
        if (isValid) {
            if (!isEmpty)
                $(fld).addClass("is-valid");
            return true;
        } else {
            $(fld).addClass("is-invalid");
            return false;
        }
    }

    function createItem(name, value) {
        localStorage.setItem(name, value);
    }


</script>


<script src="js/jquery.min.js"></script>
<script src="js/popper.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/main.js"></script>


</body>
</html>

